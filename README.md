# BankCardManagement

Проект разработан для управления банковскими картами пользователей с возможностью просмотра, переводов и администрирования.
---
# Описание Задачи

## Основная функциональность:
- **Создание и управление картами.**
- **Просмотр списка карт с фильтрами и постраничной навигацией.**
- **Возможность перевода денег между собственными картами.**

## Каждая карта обладает такими характеристиками:
- **Номер карты (маскируется как &&&& &&&& &&&& 1234)**
- **Владельца карты**
- **Срок действия карты**
- **Текущего статуса (Активна / Заблокирована / Истёк срок)**
- **Текущего баланса**
---
## Функционал

### Для Администратора:
- **Полный контроль над всеми картами (создание, блокировка, активация, удаление).**
- **Управление пользователями.**
- **Доступ ко всей информации о картах.**
### Для Пользователя:
- **Просмотр собственных карт с поддержкой фильтров и пагинации.**
- **Самостоятельная блокировка своей карты.**
- **Осуществление переводов между своими картами.**
- **Получение актуальной информации о балансе.**

## RESTful API
- **Предоставляются стандартные CRUD-операции для управления картами.**
- **Интерфейсы для осуществления переводов между картами.**

## Безопасность

### Аутентификация и Авторизация
- Используется Spring Security с конфигурацией аннотаций (`@EnableWebSecurity`, `@EnableMethodSecurity`) для настройки фильтров безопасности и управления правами доступа.
- Реализован ролевой доступ к ресурсам приложения:
  * `/admin/**`: доступна только пользователям с ролью ADMIN.
  * `/user/**`: доступна только пользователям с ролью USER.
  * Открытые маршруты (`/api/v1/auth/login`, `/register**) разрешены для всех пользователей.

### Механизмы безопасности
- Все запросы обрабатываются через `JWT Authorization Filter`, проверяющий валидность JWT-токена перед обработкой каждого запроса.
- Пользовательские пароли хранятся хешированными с использованием алгоритма bcrypt (`BCryptPasswordEncoder`), что предотвращает компрометацию данных даже при взломе базы данных.
- Для каждой сессии создается уникальный JWT-токен, срок действия которого ограничен одним днем.
- Поддерживаются механизмы обработки ошибок и отказов доступа (`CustomAccessDeniedHandler`).

### Конфиденциальность
- Куки-файлы сессионные (`JSESSIONID`) удаляются автоматически при выходе пользователя.
- CSRF-защита отключена ввиду реализации stateless подхода.

## База данных
  **Использована реляционная СУБД: PostgreSQL**

## Документация
  **Интерактивная документация доступна через Swagger UI**

## Тестирование и развёртывание
   **Автоматическое тестирование ключевых компонентов бизнес-логики средствами JUnit.**
   **Разработана инфраструктура для быстрой настройки рабочей среды с помощью Docker Compose, запуск через jar-файл**
---

### Описание docker контейнера расположено в файле Description_docker_container.txt

## Тестирование и Покрытие Кодом Проекта BankCardManagementSystem
## Цель тестирования
### Целью тестирования является обнаружение потенциальных уязвимостей и ошибок в проекте. Для достижения этой цели применяются разнообразные методики и инструменты тестирования.

## Применённые методологии тестирования
1. ### Unit-тестирование.
Каждое отдельное приложение или модуль проверяются независимо от других компонентов. Это помогает выявлять ошибки исключительно в рамках конкретного функционала, исключая влияние других элементов системы.

2. ### Интеграционное тестирование.
Проверяется совместная работа компонентов внутри приложения, например, взаимодействие контроллеров с сервисами и репозиториями. Несмотря на близость к unit-тестам, этот вид тестирования охватывает интеграционные моменты взаимодействия модулей.

3. ### Контрактное тестирование.
Используются контракты интерфейсов REST API для подтверждения правильности статуса запросов и структур JSON.

4. ### Позитивное и негативное тестирование.
Выполняются как успешные сценарии (позитивные случаи), так и отрицательные ситуации (негативные случаи, такие как передача некорректных данных, пропуск необходимых полей и др.).

## Используемые инструменты и технологии
| № | Название инструмента | Описание                              |
|---|---------------------|---------------------------------------|
| 1 | JUnit               | Библиотека для написания юнит-тестов  |
| 2 | Mockito             | Фреймворк для создания mock-объектов |
| 3 | Spring Boot Test Annotations | Аннотации для настройки контекста теста |
| 4 | Jackson ObjectMapper | Конвертирование объектов в JSON и обратно |
| 5 | MockMvc             | Имитация отправки HTTP-запросов     |
| 6 | JWT Utils           | Создание и проверка токенов JWT     |

## Отчёт о покрытии кода
### Отчет о покрытии кода был сформирован с помощью инструмента JaCoCo. Ниже представлены ключевые показатели покрытия.
---
### Общие метрики покрытия:
- **Инструкции: покрыто 69%**
- **Ветви: покрыто 43%**
- **Методы: покрыто 71%**
- **Классы: покрыто 90%**

## Детализация покрытия по пакетам:
- **org.example.service: инструкции — 58%, ветви — 38%.**
- **org.example.exception: инструкции — 44%, нет данных о ветвях.**
- **org.example.controller: инструкции — 80%, ветви — 87%.**
- **org.example.entity: инструкции — 75%, ветви — 16%.**
- **org.example.dto: инструкции — 69%, нет данных о ветвях.**
- **org.example.config: инструкции — 88%, нет данных о ветвях.**
- **org.example.util: инструкции — 88%, ветви — 50%.**
- **org.example.filter: инструкции — 100%, ветви — 75%.**

## Выводы
**Проект демонстрирует хороший общий показатель покрытия инструкций (69%). Однако покрытие ветвей (43%) и методов (71%) нуждается в улучшении. Особое внимание следует уделить пакету org.example.service, где низкий** **процент покрытия ветвей сигнализирует о недостаточном количестве тестов для сложных условий обработки данных.**

**Наиболее качественные тесты продемонстрированы в пакетах org.example.controller и org.example.filter. Их высокая степень покрытия подтверждает хорошее качество контроля качества этих областей.**

**Таким образом, дальнейшие усилия по улучшению качества тестирования следует направить на повышение покрытия ветвей и улучшение сценариев тестирования проблемных пакетов (service и entity).**